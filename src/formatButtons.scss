/* Forum and Vocabularies comments Textarea bbcode formatting buttons */

// Default container
#fast-reply-controls,
#text-controls,
// Klavotools BB_Tools_Buttons
#bb_tools_fast-reply,
#bb_tools_text {
  tr {
    display: inline-flex !important;
    flex-wrap: wrap !important;
  }

  img {
    // Individual button backgrounds using map (only names)
    $button-map: (
      "rte-quote": "quote",
      "rte-quotesel": "blockquote",
      "rte-bold": "bold",
      "rte-italic": "italic",
      "rte-underlined": "underline",
      "rte-strike": "strikethrough",
      "rte-sup": "superscript",
      "rte-sub": "subscript",
      "rte-size": "textSize",
      "rte-color": "textColor",
      "rte-background": "textBackground",
      "rte-link": "link",
      "rte-image": "image",
      "rte-hide": "spoiler",
      "rte-left": "alignLeft",
      "rte-center": "alignCenter",
      "rte-right": "alignRight",
      "rte-tab": "indent",
      "rte-list_0": "list",
      "rte-list_1": "listNumbered",
      "rte-code": "code",
      "rte-html": "html",
      "smile": "smile",
      "rte-youtube": "youtube",
    );

    @each $selector, $iconName in $button-map {
      &[src*="#{$selector}"] {
        background-image: icon($iconName, $lightblue) !important;
        &:hover {
          background-image: icon($iconName, $orange) !important;
        }
      }
    }

    // Common styles for all BBCode buttons
    &[src*="rte-quote"],
    &[src*="rte-quotesel"],
    &[src*="rte-bold"],
    &[src*="rte-italic"],
    &[src*="rte-underlined"],
    &[src*="rte-strike"],
    &[src*="rte-sup"],
    &[src*="rte-sub"],
    &[src*="rte-size"],
    &[src*="rte-color"],
    &[src*="rte-background"],
    &[src*="rte-link"],
    &[src*="rte-image"],
    &[src*="rte-hide"],
    &[src*="rte-left"],
    &[src*="rte-center"],
    &[src*="rte-right"],
    &[src*="rte-tab"],
    &[src*="rte-list"],
    &[src*="rte-listnum"],
    &[src*="rte-code"],
    &[src*="rte-html"],
    &[src*="smile"],
    &[src*="rte-youtube"] {
      border-radius: 5px !important;
      box-sizing: border-box !important;
      padding-left: 32px !important;
      width: 32px !important;
      height: 32px !important;
      border: 2px solid transparent !important;
      background-color: $black !important;
      background-position: center !important;
      background-repeat: no-repeat !important;

      &:hover {
        border-color: darken($orange, 20%) !important;
      }
    }
  }

  // Mobile responsive behavior
  @media (max-width: 460px) {
    position: relative;
    overflow: hidden !important;
    height: 32px !important; // Fixed height to show only the fake button
    
    // Hide all the actual format buttons with opacity, not display
    img, select {
      opacity: 0 !important;
      pointer-events: none !important;
    }
    
    // Create a fake button using ::before pseudo-element
    &::before {
      content: "" !important; // Three dots symbol for the fake button
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      width: 40px !important;
      height: 32px !important;
      background: $black icon("moreHorizontal", $lightblue) no-repeat center !important;
      border: 2px solid transparent !important;
      border-radius: 5px !important;
      cursor: pointer !important;
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      z-index: 10 !important;
    }
    
    // Show buttons on hover and hide fake button
    &:hover {
      height: auto !important; // Allow full height
      
      img, select {
        opacity: 1 !important;
        pointer-events: auto !important;
      }
      
      &::before {
        opacity: 0 !important;
        pointer-events: none !important;
      }
    }
  }
}